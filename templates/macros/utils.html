{% import "macros/icons.html" as icons %}

{% macro mathjax() %}
  <script id="MathJax-script" crossorigin async
          src="https://cdn.jsdelivr.net/npm/mathjax@4.0.0-beta.3/tex-mml-chtml.js">
  </script>

  <script id="MathJax-font" type="module">
    import mathjaxFiraFont from "https://cdn.jsdelivr.net/npm/mathjax-fira-font@4.0.0-beta.3/+esm"
  </script>
{% endmacro mathjax %}

{% macro load_svg(path) %}
  {% set xml = load_data(path=path) %}
  {% if xml is containing("svg") %}
    {{ xml.svg }}
  {% endif %}
{% endmacro load_svg %}

{% macro make_footer_copyright() %}
  {% if config.extra.sleek_copyright %}
    <p><em>&copy;</em> {{ now() | date(format="%Y") }}
      <a href="{{ config.base_url }}">{{ config.extra.sleek_author }}</a>
      .{{ config.extra.sleek_copyright }}.
    </p>
  {% else %}
    <p><em>&copy;</em> {{ now() | date(format="%Y") }}
      <a href="{{ config.base_url }}">Sleek</a>
      theme. Powered by Zola.
    </p>
  {% endif %}
{% endmacro make_footer_copyright %}

{% macro make_footer_taxonomies() %}
  {% if config.extra.sleek_footer_tags %}
    {% set tags = get_taxonomy(kind="tags") %}
    {% set total_count = tags.items | length %}
    <div class="taxonomies-container">
      <div class="taxonomies">
        {% for tag in config.extra.sleek_tags %}
          {% set term = get_taxonomy_term(kind="tags", term=tag) %}
          {{ icons::render_tag_icon() }}
          <a href="{{ term.permalink }}">{{ term.name }}</a>
          <span class="count">{{ term.pages | length }}</span>&nbsp;
        {% endfor %}
        <br/>
        {{ icons::render_tags_icon() }}
        {% set sleek_count = config.extra.sleek_tags | length %}
        {% if sleek_count <= total_count %}
          {% set difference = total_count - sleek_count %}
          {% if difference == 0 %}
            {{ total_count }} tags in total
          {% elif difference == 1 %}
            1 tag not shown
          {% else %}
            {{ difference }} tags not shown
          {% endif %}
        {% endif %}
      </div>
    </div>
  {% endif %}
{% endmacro make_footer_taxonomies %}


{% macro make_header_logo(logo="", abbr="") %}
  <a class="logo-link" href="{{ config.base_url }}">
    {% if logo | length != 0 %}
      <img class="logo" src="{{ get_url(path=logo) }}" alt="{{ abbr }}"/>
    {% elif abbr | length != 0 %}
      <span class="logo">{{ abbr }}</span>
    {% else %}
      <span class="logo">{{ config.base_url }}</span>
    {% endif %}
  </a>
{% endmacro make_header_logo %}

{% macro make_header_menu(menu) %}
  <nav>
    <menu class="nav-links">
      {% for target in menu %}
        <li>
          <a href="{{ config.base_url ~ target.link }}">
            {{ target.name }}
          </a>
        </li>
      {% endfor %}
      <li class="nav-search">
        <form class="search-container">
          <input id="nav-search"
                 autocomplete="off"
                 placeholder="Search..."/>
          <button id="nav-button">
            {{ icons::render_magnifying_glass() }}
          </button>
        </form>
      </li>
    </menu>
  </nav>
{% endmacro make_header_menu %}
